<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Configuration - Introduction to Netidx</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../quick_start.html"><strong aria-hidden="true">1.</strong> Quick Start</a></li><li class="chapter-item expanded "><a href="../overview.html"><strong aria-hidden="true">2.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../examples/overview.html"><strong aria-hidden="true">3.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/vmstat.html"><strong aria-hidden="true">3.1.</strong> Publishing vmstat</a></li><li class="chapter-item expanded "><a href="../examples/integration.html"><strong aria-hidden="true">3.2.</strong> Integration into an Existing System</a></li><li class="chapter-item expanded "><a href="../examples/complete_system.html"><strong aria-hidden="true">3.3.</strong> Clean Slate System Design</a></li></ol></li><li class="chapter-item expanded "><a href="../administration/overview.html"><strong aria-hidden="true">4.</strong> Administration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../administration/configuration.html" class="active"><strong aria-hidden="true">4.1.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../administration/authorization.html"><strong aria-hidden="true">4.2.</strong> Authorization</a></li><li class="chapter-item expanded "><a href="../administration/startup.html"><strong aria-hidden="true">4.3.</strong> Running the Resolver Server</a></li><li class="chapter-item expanded "><a href="../administration/listener_check.html"><strong aria-hidden="true">4.4.</strong> Listener Check</a></li><li class="chapter-item expanded "><a href="../administration/subscription_flow.html"><strong aria-hidden="true">4.5.</strong> Subscription Flow</a></li><li class="chapter-item expanded "><a href="../administration/fault_tolerance.html"><strong aria-hidden="true">4.6.</strong> Fault Tolerance</a></li></ol></li><li class="chapter-item expanded "><a href="../tools/overview.html"><strong aria-hidden="true">5.</strong> Command Line Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tools/publisher.html"><strong aria-hidden="true">5.1.</strong> publisher</a></li><li class="chapter-item expanded "><a href="../tools/subscriber.html"><strong aria-hidden="true">5.2.</strong> subscriber</a></li><li class="chapter-item expanded "><a href="../tools/resolver.html"><strong aria-hidden="true">5.3.</strong> resolver</a></li><li class="chapter-item expanded "><a href="../tools/recorder.html"><strong aria-hidden="true">5.4.</strong> recorder</a></li><li class="chapter-item expanded "><a href="../tools/container.html"><strong aria-hidden="true">5.5.</strong> container</a></li><li class="chapter-item expanded "><a href="../tools/activation.html"><strong aria-hidden="true">5.6.</strong> activation</a></li><li class="chapter-item expanded "><a href="../tools/stress.html"><strong aria-hidden="true">5.7.</strong> stress</a></li></ol></li><li class="chapter-item expanded "><a href="../browser/overview.html"><strong aria-hidden="true">6.</strong> Browser</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../browser/views.html"><strong aria-hidden="true">6.1.</strong> Constructing Custom Views</a></li><li class="chapter-item expanded "><a href="../browser/scripting.html"><strong aria-hidden="true">6.2.</strong> BScript</a></li><li class="chapter-item expanded "><a href="../browser/bscript-stdfn.html"><strong aria-hidden="true">6.3.</strong> BScript Reference Std</a></li><li class="chapter-item expanded "><a href="../browser/bscript-browser.html"><strong aria-hidden="true">6.4.</strong> BScript Reference Browser</a></li><li class="chapter-item expanded "><a href="../browser/bscript-container.html"><strong aria-hidden="true">6.5.</strong> BScript Reference Container</a></li></ol></li><li class="chapter-item expanded "><a href="../protocols/overview.html"><strong aria-hidden="true">7.</strong> Protocols Built on Netidx</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../protocols/rpc.html"><strong aria-hidden="true">7.1.</strong> Remote Procedure Call</a></li><li class="chapter-item expanded "><a href="../protocols/clustering.html"><strong aria-hidden="true">7.2.</strong> Clustering</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Introduction to Netidx</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="resolver-server-configuration"><a class="header" href="#resolver-server-configuration">Resolver Server Configuration</a></h2>
<p>Each resolver server cluster shares a configuration file. At startup
time each member server is told it's zero based index in the list of
member servers. Since the default is 0 the argument can be omitted if
there is only one server in the cluster.</p>
<p>Here is an example config file for a resolver cluster that lives in
the middle of a three level hierarchy. Above it is the root server, it
is responsible for the /app subtree, and it delegates /app/huge0 and
/app/huge1 to child servers.</p>
<pre><code class="language-json">{
  &quot;parent&quot;: {
    &quot;path&quot;: &quot;/app&quot;,
    &quot;ttl&quot;: 3600,
    &quot;addrs&quot;: [
      [
        &quot;192.168.0.1:4654&quot;,
        {
          &quot;Krb5&quot;: &quot;root/server@YOUR-DOMAIN&quot;
        }
      ]
    ]
  },
  &quot;children&quot;: [
    {
      &quot;path&quot;: &quot;/app/huge0&quot;,
      &quot;ttl&quot;: 3600,
      &quot;addrs&quot;: [
        [
          &quot;192.168.0.2:4654&quot;,
          {
            &quot;Krb5&quot;: &quot;huge0/server@YOUR-DOMAIN&quot;
          }
        ]
      ]
    },
    {
      &quot;path&quot;: &quot;/app/huge1&quot;,
      &quot;ttl&quot;: 3600,
      &quot;addrs&quot;: [
        [
          &quot;192.168.0.3:4654&quot;,
          {
            &quot;Krb5&quot;: &quot;huge1/server@YOUR-DOMAIN&quot;
          }
        ]
      ]
    }
  ],
  &quot;member_servers&quot;: [
    {
      &quot;pid_file&quot;: &quot;/var/run/netidx&quot;,
      &quot;addr&quot;: &quot;192.168.0.4:4564&quot;,
      &quot;max_connections&quot;: 768,
      &quot;hello_timeout&quot;: 10,
      &quot;reader_ttl&quot;: 60,
      &quot;writer_ttl&quot;: 120,
      &quot;auth&quot;: {
        &quot;Krb5&quot;: &quot;app/server@YOUR-DOMAIN&quot;
      }
    }
  ],
  &quot;perms&quot;: {
    &quot;/app&quot;: {
      &quot;wheel&quot;: &quot;swlpd&quot;,
      &quot;adm&quot;: &quot;swlpd&quot;,
      &quot;domain users&quot;: &quot;sl&quot;
    }
  }
}
</code></pre>
<h3 id="parent"><a class="header" href="#parent">parent</a></h3>
<p>This section is either null if the cluster has no parent, or a record
specfying</p>
<ul>
<li>
<p>path: The path where this cluster attaches to the parent. For
example a query for something in /tmp would result in a referral to
the parent in the above example, because /tmp is not a child of
/app, so this cluster isn't authoratative for /tmp. It's entirely
posible that the parent isn't authoratative for /tmp either, in
which case the client would get another referral upon querying the
parent. This chain of referrals can continue until a maximum number
is reached (to prevent infinite cycles).</p>
</li>
<li>
<p>ttl: How long, in seconds, clients should cache this parent. If for
example you reconfigured it to point to another IP, clients might
still try to go to the old ip for as long as the ttl.</p>
</li>
<li>
<p>addrs: The addresses of the servers in the parent cluster. This is a
list of pairs of ip:port and auth mechanism. The authentication
mechanism of the parent may not be Local, it must be either
Anonymous or Krb5. In the case of Krb5 you must include the server's
spn.</p>
</li>
</ul>
<h3 id="children"><a class="header" href="#children">children</a></h3>
<p>This section contains a list of child clusters. The format of each
child is exactly the same as the parent section. The path field is the
location the child attaches in the tree, any query at or below that
path will be referred to the child.</p>
<h3 id="member_servers"><a class="header" href="#member_servers">member_servers</a></h3>
<p>This section is a list of all the servers in this cluster. The fields
on each server are,</p>
<ul>
<li>
<p>pid_file: the path to the pid file you want the server to write. The
server id folowed by .pid will be appended to whatever is in this
field. So server 0 in the above example will write it's pid to
/var/run/netidx0.pid</p>
</li>
<li>
<p>addr: The socket address and port that this member server should
bind to.</p>
</li>
<li>
<p>max_connections: The maximum number of simultaneous client
connections that this server will allow. Client connections in
excess of this number will be accepted and immediatly closed (so
they can hopefully try another server).</p>
</li>
<li>
<p>hello_timeout: The maximum time, in seconds, that the server will
wait for a client to complete the initial handshake
process. Connections that take longer than this to handshake will be
closed.</p>
</li>
<li>
<p>reader_ttl: The maximum time, in seconds, that the server will retain
an idle read connection. Idle read connections older than this will
be closed.</p>
</li>
<li>
<p>writer_ttl: The maximum time, in seconds, that the server will
retain an idle write connection. Idle connections older than this
will be closed, and all associated published data will be
cleared. Publishers autoatically set their heartbeat interval to
half this value. This is the maximum amount of time data from a dead
publisher will remain in the resolver.</p>
</li>
<li>
<p>auth: The authentication mechanism used by this server. One of
Anonymous, Local, or Krb5. Local must include the path to the local
auth socket file that will be used to verify the identity of
clients. Krb5 must include the server's spn.</p>
</li>
</ul>
<h3 id="perms"><a class="header" href="#perms">perms</a></h3>
<p>The server perissions map. This will be covered in detail in the
authorization chapter. If a member server's auth mechanism is
anonymous, then this is ignored.</p>
<h2 id="client-configuration"><a class="header" href="#client-configuration">Client Configuration</a></h2>
<p>Netidx clients such as publishers and subscribers try to load their
configuration files from the following places in order.</p>
<ul>
<li>$NETIDX_CFG</li>
<li>config_dir:
<ul>
<li>on Linux: ~/.config/netidx/client.json</li>
<li>on Windows: ~\AppData\Roaming\netidx\client.json</li>
<li>on MacOS: ~/Library/Application Support/netidx/client.json</li>
</ul>
</li>
<li>global_dir
<ul>
<li>on Linux: /etc/netidx/client.json</li>
<li>on Windows: C:\netidx\client.json</li>
<li>on MacOS: /etc/netix/client.json</li>
</ul>
</li>
</ul>
<p>Since the dirs crate is used to discover these paths, they are locally
configurable by OS specific means.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code class="language-json">{
    &quot;addrs&quot;:
    [
        [&quot;192.168.0.1:4654&quot;, {&quot;Krb5&quot;: &quot;root/server@YOUR-DOMAIN&quot;}]
    ],
    &quot;base&quot;: &quot;/&quot;
}
</code></pre>
<h4 id="addrs"><a class="header" href="#addrs">addrs</a></h4>
<p>A list of pairs or ip:port and auth mechanism for each server in the
cluster. Local should include the path to the local authentication
socket file. Krb5 should include the server's spn.</p>
<h4 id="base"><a class="header" href="#base">base</a></h4>
<p>The base path of this server cluster in the tree. This should
correspond to the server cluster's parent, or &quot;/&quot; if it's parent is
null.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../administration/overview.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../administration/authorization.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../administration/overview.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../administration/authorization.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
